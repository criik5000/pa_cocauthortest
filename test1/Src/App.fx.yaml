App As appinfo:
    BackEnabled: =true
    ConfirmExit: =true
    ConfirmExitMessage: ="Please confirm you wish to exit"
    Formulas: |-
        =/////////////////////////////////////////////
        // App Specific Formulas
        /////////////////////////////////////////////
        //cardHeightMS = (cnt_MainContent_RightColumn_MS.Height - (cnt_MainContent_RightColumn_MS.PaddingTop+cnt_MainContent_RightColumn_MS.PaddingBottom) - (14*cnt_MainContent_RightColumn_MS.LayoutGap)) / 15;
        
        /////////////////////////////////////////////
        // Template Formulas
        /////////////////////////////////////////////
        appTitle=card_AppTitle.ValueText;
        appReference=Lower(card_AppReference.ValueText);
        site=card_Site.ValueText;
        templateSetting=card_TemplateSetting.ValueText;
        howToURL=card_HowToURL.ValueText;
        metricsList=card_MetricsList.ValueText;
        currentUser=User();
        versionNumber=toolInformation.VersionNumber;
        accessMetrics = 
            {
                AppTitle:appTitle,
                AppReference:toolInformation.AppReference,
                Site:site,
                List:metricsList,
                User:currentUser.FullName,
                Parameters:"",
                Additional:"",
                Version:toolInformation.VersionNumber
            };
        
        ///////////////////////////////////////////////////
        // Settings to change for different environments //
        ///////////////////////////////////////////////////
        // This account is for any additional "service" accounts that do not show up in your "Admins" security group
        svcAccount=Office365Users.SearchUserV2({searchTerm:"svc_et2rc@bah.com"}).value;
        colAdmin=
            Table(
                ForAll(
                    Office365Groups.ListGroupMembers("d44295e8-f04f-4c40-a694-d127ccb9c36a").value, // GUID for your Admin security group
                    {Mail: mail,EntraId:id}
                ),
                {Mail: First(svcAccount).Mail,EntraId:First(svcAccount).Id}
            );
        isAdmin=!IsBlank(LookUp(colAdmin,EntraId = Lower(currentUser.EntraObjectId)));
        //////////////////////////////////////////////////
        // End Settings for different environments      //
        //////////////////////////////////////////////////
        HelperSizes = 
            {
                LogoWidth: 250,
                TitleWidth: 500
            };
        TemplateSizes =
            {
                HeaderHeight: 80,
                LogoWidth: HelperSizes.LogoWidth,
                TitleWidth: HelperSizes.TitleWidth,
                TopNavigationWidth: App.Width - (HelperSizes.LogoWidth + HelperSizes.TitleWidth),
                LeftNavigationArrowSize: 40,
                LeftNavigationWidth: 80,
                InnerNavigationHeight: 50,
                SubmenuHeight: 33,
                VerticalPadding: 3,
                HorizontalPadding: 3
            };
        FontSizes =
            {
                TextMain:                           ThisTheme.FontSize -1,
                TextEmphasis:                       ThisTheme.FontSize +1,
                TextMinor:                          ThisTheme.FontSize -4,
                Content:                            ThisTheme.FontSize +2,
                Title:                              ThisTheme.FontSize +6,
                SubTitle:                           ThisTheme.FontSize +4,
                AddPicture:                         ThisTheme.FontSize -3
            };
        
        /////////////////////////////////////////////
        //                                         //
        // -- Set Control-level Font properties -- //
        //                                         //
        //    This is separated from the above     //
        //  to enable easy changing of font size   //
        //                                         //
        /////////////////////////////////////////////
        ControlsFontSizes = 
            {
                AppTitleFontSize:                   FontSizes.Title,
                LabelFontSize:                      FontSizes.TextMain,
                ButtonFontSize:                     FontSizes.TextEmphasis,
                InputFontSize:                      FontSizes.TextMain,
                DropdownFontSize:                   FontSizes.TextMain,
                ComboBoxFontSize:                   FontSizes.TextMain,
                DatePickerFontSize:                 FontSizes.TextMain,
                ListBoxFontSize:                    FontSizes.TextMain,
                CheckBoxFontSize:                   FontSizes.TextMain,
                RadioFontSize:                      FontSizes.TextMain,
                ToggleFontSize:                     FontSizes.TextMain,
                TimerFontSize:                      FontSizes.Title,
                BarcodeFontSize:                    FontSizes.TextEmphasis,
                AddPictureFontSize:                 FontSizes.AddPicture,
                ImportFontSize:                     FontSizes.TextEmphasis,
                ExportFontSize:                     FontSizes.TextEmphasis,
                ChartLegendFontSize:                FontSizes.AddPicture,
                GallerytitleLabelFontSize:          FontSizes.Title,
                GallerysubtitleLabelFontSize:       FontSizes.SubTitle,
                GallerycontentLabelFontSize:        FontSizes.Content,
                AttachmentFontSize:                 FontSizes.TextMain,
                FormTitleLabelFontSize:             FontSizes.TextMain,
                DataTableFontSize:                  FontSizes.TextMain,
                DataTableHeadingFontSize:           FontSizes.TextEmphasis
            };
        
        ControlsTheme =
            {
        
                LabelTextColor:                     ThisTheme.Color1Text,
                LabelFill:                          ColorFade(ThisTheme.Color1,-30%),
                LabelBorderColor:                   ThisTheme.Color2,
                LabelFont:                          ThisTheme.Font,
        
                ButtonColor:                        ThisTheme.Color1Text,
                ButtonFill:                         ThisTheme.Color1,
                ButtonBorderColor:                  ThisTheme.Color3,
                ButtonHoverColor:                   ColorFade(ThisTheme.Color1Text, 20%),
                ButtonHoverFill:                    ColorFade(ThisTheme.Color1,     20%),
                ButtonHoverBorderColor:             ColorFade(ThisTheme.Color3,     20%),
                ButtonPressedColor:                 ThisTheme.Color1,
                ButtonPressedFill:                  ThisTheme.Color1Text,
                ButtonPressedBorderColor:           ThisTheme.Color1,
                ButtonFont:                         ThisTheme.Font,
                ButtonRadiusTopLeft:                5,
                ButtonRadiusTopRight:               5,
                ButtonRadiusBottomLeft:             5,
                ButtonRadiusBottomRight:            5,
                NavButtonRadiusTopLeft:             15,
                NavButtonRadiusTopRight:            15,
                NavButtonRadiusBottomLeft:          0,
                NavButtonRadiusBottomRight:         0,
                NavButtonFill:                      ThisTheme.Color1,
                NavButtonColor:                     ThisTheme.Color1Text,
                NavButtonSelectedFill:              ThisTheme.Color2,
                NavButtonSelectedColor:             ThisTheme.Color2Text,
                
                InputTextColor:                     ThisTheme.Color1Text,
                InputFill:                          ThisTheme.defaultFill,//ThisTheme.Color1,
                InputBorderColor:                   ThisTheme.Color2,
                InputHoverColor:                    ColorFade(ThisTheme.Color1Text, 20%),
                InputHoverFill:                     ColorFade(ThisTheme.Color1, 20%),
                InputHoverBorderColor:              ColorFade(ThisTheme.Color2, 20%),
                InputPressedColor:                  ThisTheme.Color1Text,
                InputPressedFill:                   ThisTheme.Color1,
                InputPressedBorderColor:            ColorFade(ThisTheme.Color2, 20%),
                InputFont:                          ThisTheme.Font,
                InputDelayOutput:                   true,
                InputRadiusTopLeft:                 5,
                InputRadiusTopRight:                5,
                InputRadiusBottomLeft:              5,
                InputRadiusBottomRight:             5,
        
                PenInputInkColor:                   ThisTheme.defaultTextColor,
                PenInputBorderColor:                ThisTheme.defaultTextColor,
                PenInputInkSize:                    2,
                PenInputBackground:                 Color.Transparent,
        
                DropdownTextColor:                  ThisTheme.defaultTextColor,//ThisTheme.Color1Text,
                DropdownFill:                       ThisTheme.defaultFill,//ThisTheme.Color1,
                DropdownBorderColor:                ThisTheme.Color2,
                DropdownHoverColor:                 ColorFade(ThisTheme.Color1Text, 20%),
                DropdownHoverFill:                  ColorFade(ThisTheme.Color1, 20%),
                DropdownHoverBorderColor:           ColorFade(ThisTheme.Color2, 20%),
                DropdownPressedColor:               ThisTheme.Color1,
                DropdownPressedFill:                ThisTheme.defaultTextColor,//ThisTheme.Color1Text,
                DropdownPressedBorderColor:         ColorFade(ThisTheme.Color2, -20%),
                DropdownChevronBackground:          ThisTheme.Color2,
                DropdownChevronFill:                ThisTheme.Color2Text,
                DropdownChevronHoverBackground:     ColorFade(ThisTheme.Color2, 20%),
                DropdownChevronHoverFill:           ColorFade(ThisTheme.Color2Text, 20%),
                DropdownSelectionColor:             ThisTheme.Color3Text,
                DropdownSelectionFill:              ThisTheme.Color3,
                DropdownFont:                       ThisTheme.Font,
        
                ComboBoxTextColor:                  ThisTheme.Color1Text,
                ComboBoxFill:                       ThisTheme.defaultFill,//ThisTheme.Color1,
                ComboBoxBorderColor:                ThisTheme.Color2,
                ComboBoxHoverColor:                 ColorFade(ThisTheme.Color1Text, 20%),
                ComboBoxHoverFill:                  ColorFade(ThisTheme.defaultFill,20%),//ThisTheme.Color1, 20%),
                ComboBoxHoverBorderColor:           ColorFade(ThisTheme.Color2, 20%),
                ComboBoxPressedColor:               ThisTheme.Color2Text,
                ComboBoxPressedFill:                ThisTheme.Color2,
                ComboBoxPressedBorderColor:         ColorFade(ThisTheme.Color2, -20%),
                ComboBoxSelectionColor:             ThisTheme.Color3Text,
                ComboBoxSelectionFill:              ThisTheme.Color3,
                ComboBoxChevronBackground:          ThisTheme.Color2,
                ComboBoxChevronFill:                ThisTheme.Color2Text,
                ComboBoxChevronHoverBackground:     ColorFade(ThisTheme.Color2, 20%),
                ComboBoxChevronHoverFill:           ColorFade(ThisTheme.Color2Text, 20%),
                ComboBoxFont:                       ThisTheme.Font,
                ComboBoxMoreItemsButtonColor:       ThisTheme.Color2,
                
                DatePickerColor:                    ThisTheme.Color1Text,
                DatePickerFill:                     ThisTheme.defaultFill,//ThisTheme.Color1,
                DatePickerBorderColor:              ThisTheme.Color2,
                DatePickerIconFill:                 ThisTheme.Color2Text,
                DatePickerIconBackground:           ThisTheme.Color2,
                DatePickerSelectedDateFill:         ThisTheme.Color2,
                DatePickerHoverDateFill:            ThisTheme.Color3Text,
                DatePickerHeaderFill:               ThisTheme.Color3,
                DatePickerFont:                     ThisTheme.Font,
                //
                // Sancho's note:
                // Tried to template these but IDE import only picks up design properties currently :(
                //
                // DatePickerStartOfWeek:          StartOfWeek.Monday,
                // DatePickerFormat:               DateTimeFormat.ShortDate,
                // DatePickerDefaultDate:          Today(),
                // DatePickerDateTimeZone:         DateTimeZone.Local,
                // DatePickerLanguage:             "en-GB",
                ListBoxTextColor:                   ThisTheme.defaultTextColor,//ThisTheme.Color1Text,
                ListBoxFill:                        ThisTheme.defaultFill,//ThisTheme.Color1,
                ListBoxBorderColor:                 ThisTheme.Color2,
                ListBoxHoverColor:                  ColorFade(ThisTheme.Color1Text, 20%),
                ListBoxHoverFill:                   ColorFade(ThisTheme.Color1, 20%),
                ListBoxHoverBorderColor:            ColorFade(ThisTheme.Color2, 20%),
                ListBoxPressedColor:                ThisTheme.Color2Text,
                ListBoxPressedFill:                 ThisTheme.Color2,
                ListBoxPressedBorderColor:          ColorFade(ThisTheme.Color2, -20%),       
                ListBoxSelectionColor:              ThisTheme.Color3Text,
                ListBoxSelectionFill:               ThisTheme.Color3,
                ListBoxFont:                        ThisTheme.Font,
                ListBoxItemPaddingLeft:             10,
        
                CheckBoxTextColor:                  ThisTheme.Color1Text,
                CheckBoxInnerBackground:            ThisTheme.defaultFill,/*If(
                                                        ThisTheme.DarkMode,
                                                        ColorFade(ThisTheme.Color1, -50%),
                                                        ColorFade(ThisTheme.Color1, 50%)
                                                    ),*/
                CheckBoxBorderColor:                ThisTheme.Color2,
                CheckBoxHoverColor:                 ColorFade(ThisTheme.Color1Text, 20%),
                CheckBoxHoverFill:                  ColorFade(Color.Transparent, 20%),
                CheckBoxHoverBorderColor:           ColorFade(ThisTheme.Color2, 20%),
                CheckBoxPressedColor:               ColorFade(ThisTheme.Color1Text, -20%),
                CheckBoxPressedFill:                ColorFade(Color.Transparent, -20%),
                CheckBoxPressedBorderColor:         ColorFade(ThisTheme.Color2, -20%),
                CheckBoxOutsideBorderColor:         ThisTheme.Color2,
                CheckBoxFill:                       Color.Transparent,
                CheckBoxCheckmarkFill:              ThisTheme.Color1Text,
                CheckBoxFont:                       ThisTheme.Font,
                CheckBoxSize:                       40,
                
                RadioTextColor:                     ThisTheme.defaultTextColor,
                RadioOutsideFill:                   Color.Transparent,
                RadioOutsideBorderColor:            ThisTheme.Color2,
                RadioHoverColor:                    ThisTheme.Color2,
                RadioHoverFill:                     Color.Transparent,
                RadioPressedColor:                  ThisTheme.defaultTextColor,
                RadioPressedFill:                   Color.Transparent,
                RadioBorderColor:                   ThisTheme.Color2,
                RadioBackgroundFill:                If(ThisTheme.DarkMode,
                                                        ColorFade(ThisTheme.Color1, -50%),
                                                        ColorFade(ThisTheme.Color1, 50%)
                                                    ),
                RadioSelectionFill:                 ThisTheme.defaultTextColor,
                RadioFont:                          ThisTheme.Font,
                RadioSize:                          40,
                RadioLayout:                        Layout.Horizontal,
                
                ToggleTextColor:                    ThisTheme.defaultTextColor,
                ToggleBorderColor:                  ThisTheme.Color2,
                ToggleHandleFill:                   ThisTheme.Color2,
                ToggleFalseFill:                    ThisTheme.Color1,
                ToggleTrueFill:                     ThisTheme.Color3,
                ToggleFalseHoverFill:               ColorFade(ThisTheme.Color1, 20%),
                ToggleTrueHoverFill:                ColorFade(ThisTheme.Color3, 20%),
                ToggleHoverBorderColor:             ColorFade(ThisTheme.Color2, 20%),
                TogglePressedBorderColor:           ColorFade(ThisTheme.Color2, -20%),
                ToggleFont:                         ThisTheme.Font,
                ToggleTextPosition:                 TextPosition.Left,
        
                SliderBorderColor:                  ThisTheme.Color2,
                SliderHandleFill:                   Color.White,
                SliderBackground:                   ThisTheme.Color3,
                SliderValueFill:                    ThisTheme.Color2,
                SliderHandleHoverFill:              ColorFade(Color.White, 20%),
                SliderHandleActiveFill:             ColorFade(Color.White, 40%),
                SliderRailHoverFill:                ColorFade(ThisTheme.Color3,  20%),
                SliderValueHoverFill:               ColorFade(ThisTheme.Color2,  20%),
                SliderHoverBorderColor:             ColorFade(ThisTheme.Color2,  20%),
                SliderPressedBorderColor:           ColorFade(ThisTheme.Color2, -20%),
                SliderRailThickness:                24,
                SliderHandleSize:                   24,
        
                RatingItemFill:                     ThisTheme.Color2,
                RatingFill:                         Color.Transparent,
                RatingBorderColor:                  ThisTheme.Color2,
        
                TimerTextColor:                     ThisTheme.Color1Text,
                TimerFill:                          ThisTheme.Color1,
                TimerBorderColor:                   ColorFade(ThisTheme.Color1, -20%),
                TimerHoverColor:                    ColorFade(ThisTheme.Color1Text, 20%),
                TimerHoverFill:                     ColorFade(ThisTheme.Color1,  20%),
                TimerHoverBorderColor:              ColorFade(ThisTheme.Color1,  20%),
                TimerPressedColor:                  ThisTheme.Color1,
                TimerPressedFill:                   ThisTheme.Color1Text,
                TimerPressedBorderColor:            ThisTheme.Color1,
                TimerFont:                          ThisTheme.Font,
                
                ImageFill:                          Color.Transparent,
                ImageBorderColor:                   Color.Transparent,
                ImageHoverFill:                     Color.Transparent,
                ImageHoverBorderColor:              Color.Transparent,
                ImagePressedFill:                   Color.Transparent,
                ImagePressedBorderColor:            Color.Transparent,
                ImageRadiusTopLeft:                 0,
                ImageRadiusTopRight:                0,
                ImageRadiusBottomLeft:              0,
                ImageRadiusBottomRight:             0,
        
                CameraBorderColor:                  ThisTheme.Color2,
        
                BarcodeColor:                       ThisTheme.Color1Text,
                BarcodeFill:                        ThisTheme.Color1,
                BarcodeBorderColor:                 ThisTheme.Color2,
                BarcodeHoverColor:                  ColorFade(ThisTheme.Color1Text, 20%),
                BarcodeHoverFill:                   ColorFade(ThisTheme.Color1, 20%),
                BarcodeHoverBorderColor:            ColorFade(ThisTheme.Color2, 20%),
                BarcodePressedColor:                ThisTheme.Color1,
                BarcodePressedFill:                 ThisTheme.Color1Text,
                BarcodePressedBorderColor:          ThisTheme.Color1,
                BarcodeFont:                        ThisTheme.Font,
                
                VideoFill:                          ThisTheme.Color1,
                VideoBorderColor:                   ThisTheme.Color2,
        
                StreamColor:                        ThisTheme.defaultTextColor,
                StreamFill:                         Color.Transparent,
                StreamBorderColor:                  ThisTheme.Color2,
        
                AudioFill:                          ThisTheme.Color1,
                AudioBorderColor:                   ColorFade(ThisTheme.Color1, -20%),
        
                MicrophoneColor:                    ThisTheme.Color1Text,
                MicrophoneFill:                     ThisTheme.Color1,
                MicrophoneBorderColor:              ColorFade(ThisTheme.Color1, -20%),
                MicrophoneHoverColor:               ColorFade(ThisTheme.Color1Text, 20%),
                MicrophoneHoverFill:                ColorFade(ThisTheme.Color1, 20%),
                MicrophoneHoverBorderColor:         ThisTheme.Color1,
                MicrophonePressedColor:             ColorFade(ThisTheme.Color1Text, -20%),
                MicrophonePressedFill:              ColorFade(ThisTheme.Color1, -20%),
                MicrophonePressedBorderColor:       ColorFade(ThisTheme.Color1, -40%),
        
                AddPictureColor:                    ThisTheme.Color1Text,
                AddPictureFill:                     ThisTheme.Color1,
                AddPictureBorderColor:              ThisTheme.Color2,
                AddPictureHoverColor:               ThisTheme.Color1Text,
                AddPictureHoverFill:                ColorFade(ThisTheme.Color1, 20%),
                AddPictureHoverBorderColor:         ColorFade(ThisTheme.Color2, 20%),
                AddPicturePressedColor:             ThisTheme.Color1Text,
                AddPicturePressedFill:              ColorFade(ThisTheme.Color1, -20%),
                AddPicturePressedBorderColor:       ColorFade(ThisTheme.Color2, -20%),
                AddPictureFont:                     ThisTheme.Font,
        
                ImportColor:                        ThisTheme.Color1Text,
                ImportFill:                         ThisTheme.Color1,
                ImportBorderColor:                  ColorFade(ThisTheme.Color1, -20%),
                ImportFont:                         ThisTheme.Font,
                ImportHoverColor:                   ColorFade(ThisTheme.Color1Text, 20%),
                ImportHoverFill:                    ColorFade(ThisTheme.Color1, 20%),
                ImportHoverBorderColor:             ThisTheme.Color1,
                ImportPressedColor:                 ThisTheme.Color1Text,
                ImportPressedFill:                  ColorFade(ThisTheme.Color1, -20%),
                ImportPressedBorderColor:           ColorFade(ThisTheme.Color1, -40%),
        
                ExportColor:                        ThisTheme.Color1Text,
                ExportFill:                         ThisTheme.Color1,
                ExportBorderColor:                  ColorFade(ThisTheme.Color1, -20%),
                ExportFont:                         ThisTheme.Font,
                ExportHoverColor:                   ColorFade(ThisTheme.Color1Text, 20%),
                ExportHoverFill:                    ColorFade(ThisTheme.Color1, 20%),
                ExportHoverBorderColor:             ThisTheme.Color1,
                ExportPressedColor:                 ThisTheme.Color1Text,
                ExportPressedFill:                  ColorFade(ThisTheme.Color1, -20%),
                ExportPressedBorderColor:           ColorFade(ThisTheme.Color1, -40%),
        
                ChartLegendColor:                   ThisTheme.defaultTextColor,
                ChartLegendFont:                    ThisTheme.Font,
        
                /////////////////
                //
                // Gallery Items
                //
                GalleryFill:                        RGBA(0,0,0,0),
                GalleryBorderColor:                 ThisTheme.Color2,
                //
                // Gallery Title and Subtitle
                //
                GallerytitleLabelColor:             ThisTheme.Color3,
                GallerysubtitleLabelColor:          ThisTheme.defaultTextColor,
                GallerytitleLabelFont:              ThisTheme.Font,
                GallerysubtitleLabelFont:           ThisTheme.Font,
                //
                // Body content label in Flexible Height Gallery
                //
                GallerycontentLabelColor:           ThisTheme.defaultTextColor,
                GallerycontentLabelFont:            ThisTheme.Font,
                //
                /////////////////
        
                /////////////////
                //
                // Icons
                //
                // This will apply to all icons
                // (excluding new screen icons used as BGs)
                //
                // IconFill is also used for the background shape of
                // the New Screen headers in: List
                //
                IconFill:                           ThisTheme.Color3,
                IconHoverFill:                      ThisTheme.Color3Text,
                IconPressedFill:                    ThisTheme.Color1,
                // Background set to Transparent by default to preserve New Screen-based icons
                IconBackground:                     Color.Transparent,
                IconHoverBackground:                Color.Transparent,
                IconPressedBackground:              Color.Transparent,
                IconBorderColor:                    ColorFade(ThisTheme.Color3, -20%),
                IconHoverBorderColor:               ThisTheme.Color3,
                IconPressedBorderColor:             ColorFade(ThisTheme.Color3, -40%),
                
                AttachmentTextColor:                ThisTheme.Color1Text,
                AttachmentFill:                     ThisTheme.Color1,
                AttachmentBorderColor:              ThisTheme.Color2,
                AttachmentHoverColor:               ColorFade(ThisTheme.Color1Text, 20%),
                AttachmentHoverFill:                ColorFade(ThisTheme.Color1, 20%),
                AttachmentHoverBorderColor:         ColorFade(ThisTheme.Color2, 20%),
                AttachmentFont:                     ThisTheme.Font,
                AttachmentPressedColor:             ThisTheme.Color2Text,
                AttachmentPressedFill:              ThisTheme.Color2,
                AttachmentItemColor:                ThisTheme.Color3Text,
                AttachmentItemFill:                 ThisTheme.Color3,
                AttachmentItemHoverColor:           ColorFade(ThisTheme.Color3Text, 20%),
                AttachmentItemHoverFill:            ColorFade(ThisTheme.Color3, 20%),
        
                /////////////////
                //
                // Forms
                //
                EditFormBorderColor:                ThisTheme.Color2,
                EditFormFill:                       If( 
                                                        ThisTheme.DarkMode,
                                                        ColorFade(ThisTheme.Color1, -50%),
                                                        ColorFade(ThisTheme.Color1, 50%)
                                                    ),
                ViewFormBorderColor:                ThisTheme.Color2,
                ViewFormFill:                       If(
                                                        ThisTheme.DarkMode,
                                                        ColorFade(ThisTheme.Color1, -50%),
                                                        ColorFade(ThisTheme.Color1, 50%)
                                                    ),
                // Form Title and * fields
                FormTitleLabelColor:                ThisTheme.Color3,
                FormTitleLabelFont:                 ThisTheme.Font,
        
                /////////////////
                //
                // Screen
                //
                ScreenBackground:                   /*If( 
                                                        ThisTheme.DarkMode,
                                                        ColorFade(ThisTheme.BackgroundColor, -50%),
                                                        ColorFade(ThisTheme.BackgroundColor, 50%)
                                                    ),*/
                                                    ColorValue("#e6e6e2"),
        
                /////////////////
                //
                // Data Table
                //
                //
                // NotUsed
                   DataTableColor1:                    ThisTheme.Color1,
                   DataTableColor2:                    ThisTheme.Color2,
                // Border Lines between headers
                DataTableColor3:                    ThisTheme.Color3,
                //
                DataTableColor:                     ThisTheme.Color1Text,
                DataTableFill:                      ThisTheme.Color1,
                DataTableColorInverted:             ThisTheme.Color3Text,
                DataTableSelectedColor:             ThisTheme.Color3Text,
                DataTableSelectedFill:              ThisTheme.Color3,
                DataTableHoverColor:                ThisTheme.Color2Text,
                DataTableHoverFill:                 ThisTheme.Color2,
                DataTableBorderColor:               ThisTheme.Color2,
                DataTableInputFill:                 ThisTheme.Color1,
                DataTableFont:                      ThisTheme.Font,
                DataTableHeadingFont:               ThisTheme.Font,
                DataTableHeadingColor:              ThisTheme.Color2Text,
                DataTableHeadingFill:               ThisTheme.Color2,
                DataTableFontWeight:                FontWeight.Normal,
                DataTableHeadingFontWeight:         FontWeight.Semibold,
        
                /////////////////
                //
                // PDFViewer & PowerBI
                //
                PdfViewerFill:                      ColorFade(ThisTheme.Color1, -50%),
                PdfViewerBorderColor:               ThisTheme.Color2,
                PowerBIBorderColor:                 ThisTheme.Color2,
                
                //////////////////////////////////////////////////
                //                                              //
                //  These apply to the Insert>New Screen items  //
                //                                              //
                //////////////////////////////////////////////////
                //
                // Title Label on New Screen Headers
                //
                invertedBkgHeaderLabelColor:        ThisTheme.Color2Text,
                //
                // New Screen Header background shape for:
                // Scrollable, Email, People, Meeting,
                // 
                // also selected tab shape colour on Meeting screen
                // see: IconFill also used for other new screen header shapes
                //
                IconFillInverted:                   ThisTheme.Color2,
                //
                // Label on Success Screen, Tutorial Screen
                // To / Subject / Message Title on Email screen
                // SubTitle label on PeopleBrowseGallery on Email Screen
                // Attendees/Subject/Message labels on Meeting screen
                // No Times/Locations labels on Schedule tab of Meeting Screen
                // All Left-side labels, and right-side time labels on Calendar screen
                // ALSO:
                // SubHeader Text Colour on Calendar Screen - NB this is same as BG colour
                // SubHeader Text Colour on Schedule tab of Meeting screen - NB this is same as BG colour
                //
                basicNoSizeLabelColor:              ThisTheme.Color3,
                //
                // Tick on Success Screen
                // Send Icon Color on Email Screen
                //
                invertedBkgHeaderIconColor:         ThisTheme.Color3Text,
                //
                // Title label and icon color in PeopleGallery on Email Screen, People Screen and Meeting Screen
                //
                basicNoSizeInvertedBkgLabelColor:   ThisTheme.Color3Text,
                //
                // Invite & Schedule tab header label on Meeting screen
                // Rooms list name label on Schedule tab on Meeting Screen
                //
                basicNoSizeWeightColorLabelColor:   ThisTheme.defaultTextColor
            };
        
        ReservedChartColorSet=
            ForAll(
                Split(ThisTheme.ChartColors,","),
                {
                    Value:ColorValue(Value)
                }
            );
        
        
        //////////////////////////////////////////////////
        //                                              //
        //  Values pulled from Admin Settings           //
        //////////////////////////////////////////////////
        //appTitle = card_AppTitle.ValueText;
        //appReference = Lower(card_AppReference.ValueText);
        //howToURL = card_HowToURL.ValueText;
        
        //versionNumber = LookUp(MALT_ToolInformation,MALT_ToolInformation[@AppReference]=appReference).VersionNumber;
        
        //////////////////////////////////////////////////
        //                                              //
        //  Section for settings up the custom settings //
        //////////////////////////////////////////////////
        
        InnerNavigationButtons=
            [
            {
                ID: 1,
                Name: "Button1",
                Label: "Button 1",
                Action: "Display",
                Image: SampleImage,
                Description: "Tooltip",
                Color: ControlsTheme.ButtonColor,
                SelectedColor: ControlsTheme.ButtonColor,
                FillColor: ControlsTheme.NavButtonFill,
                SelectedFillColor: ControlsTheme.NavButtonSelectedFill
            },
            {
                ID: 2,
                Name: "Button2",
                Label: "Button 2",
                Action: "Display",
                Description: "Tooltip"
            }
            ];
        
        fx_drp = {
            EmployeeType:["Booz Allen","Subcontractor","Guest Users"],
            TaskOrderStatus:["Active","Temporary","On Leave","Out-Processing"],
            TaskOrderStatusSPLJM:["Pre-Onboarding","Active","Temporary","On Leave","Out-Processing"],
            TaskOrderStatusPMO:["Pre-Onboarding","Active","Temporary","On Leave","Out-Processing","Inactive"],
            LocationType:["Client Site","Booz Allen Office","Subcontractor Site","Telework"],
            EmailPreference:["Booz Allen Email","Booz Allen Email and DoD Email"], 
            YesNo:["Yes","No"],
            BIXProjectRole:["BAH - Team Member","No Longer on Task Order","Subcontractor","BAH - Program PMO","BAH - Job Manager (JM Approver)","BAH - Project Manager (SPL - Approver)","BAH Program Financial Manager","Client - COR","Client - PfM","Client - Team Member","BAH - Super PBS"],
            BIXAccountStatus:["Created and Activated","BIX Account Deactivated"],
            OktaStatus:["Submitted to BIX","Created and Activated","Okta Account Deactivated","Okta Not Requested"],
            YesNONA:["Yes","No","N/A"],
            A365Status:["Added to All Staff","Cannot Find User","Removed, N/A, Pending A365 Account"],
            OutProcessingStatus:["Not Started","In Progress","Completed"],
            CACBadgeTokenStatus:["Revoked","Turned In","N/A","Not Actioned"],
            HandReceiptsCleared:["Yes","Not Actioned","N/A"],
            BIXAirfareClosed:["Yes","Not Actioned"],
            FamilySize:["1","2","3","4","5","6","7","8"],
            AssignmentAgreementStatus:["Choice1","Choice2","Choice3"],
            EducationType:["Civilian","Military","Other"],
            Certification:["Education","Certificate","DoD System Proficiency"],
            Company:["Avion", "BigBear.ai","Catharsis Productions","Conflict Kinetics","DAVetTechs, LCC","E-PAGA","ECSTech","ERPi","Horizon Strategies","Innovative Reasoning", "Insight Global","KCK Tech","L2 Defense","MBO Partners","MKGCS LLC","NuWave","Operational Intelligence","ProSol","Ravenswood","Streamline Defense","Technomics","The Ventura Group (TVG)","Tribalco","Trideum","Turtle Reef Holdings, LLC","Valbin"],
            CertificateStatus:["Current","N/A","30 Days Until Due","Expired","Missing"]
        
         };
        TrainingCourses = 
            ShowColumns(
                PRTrainingInformation,
                Title,
                Ref,
                DisplayName,
                Link,
                Description
            );
        
        colTDL=
        AddColumns(
        		ShowColumns(
        			Filter(
        				TDLAssignment,
        				ContractStatus="Active"
        			),
        			ContractStatus,
        			OptionYear,
        			Organization,
        			TDLNumber,
        			'TDL/TDP Title',
        			WorkTracker_Number,
        			LaborNumber,
        			LaborDescription,
        			Description,
        			TaskNumber,
        			PfM,
        			ALT_PfM,
        			SPL,
        			Alt_SPL,
        			JM,
        			Alt_JM,
        			PCO,
        			StartDate,
        			PopEndDate,
        			Task1Percentage,
        			Task2Percentage,
        			Task3Percentage,
        			Task4Percentage,
        			Task5Percentage,
        			Task6Percentage,
        			FTEBoozAllen,
        			FTESubcontractor,
        			ScopeOfWork,
        			ApprovedModDate,
        			KickOffMeetingScheduled,
        			KickOffMeetingMinutesSubmitted,
        			KickOffMeetingDate,
        			SecuritySSO,
        			TASSName,
        			TASSEmail,
        			TASSPhone,
        			Clearances,
        			ClientName,
        			ProjectName
        		),Value,TDLNumber);
                
        currentRecord=
            {
                Reference_ID:Value(varPRID), //Number
                EmployeeType:cmp_EmployeeType_EI.ValueText,
                TaskOrderStatus:cmp_TaskOrderStatus_EI.ValueText,
                TaskOrderStartDate:cmp_StatusDate_EI.ValueDate, //Date
                EmployeeName: First(varRecord).EmployeeName, //Person or Group
                EmployeeFirstName:Trim(Left(cmp_EmployeeName_EI.ValueText,Find(" ",cmp_EmployeeName_EI.ValueText))),
                EmployeeLastName:Trim(Mid(cmp_EmployeeName_EI.ValueText,Find(" ",cmp_EmployeeName_EI.ValueText),Len(cmp_EmployeeName_EI.ValueText))),
                AccountGroup:cmp_AccountGroup_EI.ValueText,
                EmployeeID:cmp_ID_EI.ValueText,
                CompanyEmail:cmp_CompanyEmail_EI.ValueText,
                Company:cmp_Company.ValueText,
                PrimaryPhone:cmp_Primary_EI.ValueText,
                LocationType:cmp_LocationType_EI.ValueText,
                DutyLocation:cmp_DutyLocation_EI.ValueText,
                Country:cmp_Country_EI.ValueText,
                State:cmp_State_EI.ValueText,
                City:cmp_City_EI.ValueText,
                ReturnDate:cmp_StatusDate_EI.ValueDate, //Date
                EmailNotificationPreference:cmp_EmailNotification_EI.ValueText,
                LCAT:cmp_LCAT_EI.ValueText,
                JobLeader:cmp_JL_EI.ValuePerson, //Person or Group
                PrimaryTDL:varPrimaryTDL,
                RequiresRelocation:cmp_RequiresRelo_EI.ValueText,
                BIXProjectRole:Coalesce(cmp_ProjectRole_AC.ValueText,First(varRecord).BIXProjectRole),
                BIXAccountStatus:Coalesce(cmp_AccountStatus_AC.ValueText,First(varRecord).BIXAccountStatus),
                OktaStatus:Coalesce(cmp_OktaAccountStatus_AC.ValueText,First(varRecord).OktaStatus),
                ET2RCDistro:Coalesce(cmp_ET2RCDistro_AC.ValueText,First(varRecord).ET2RCDistro),
                A365Status:Coalesce(cmp_A365Status_AC.ValueText,First(varRecord).A365Status),
                A365DateChange:Coalesce(cmp_StatusChange_AC.ValueDate,First(varRecord).A365DateChange), //Date
                LCATValidated:Coalesce(cmp_LCATValidated_AC.ValueText,First(varRecord).LCATValidated),
                WelcomeEmailSent:Coalesce(cmp_WelcomeEmailSent_AC.ValueDate,First(varRecord).WelcomeEmailSent), //Date
                CurrentAccessLevel:Coalesce(cmp_CurrentAccessLevel_AC.ValueText,First(varRecord).CurrentAccessLevel),
                EligibilityLevel:Coalesce(cmp_EligibilityLevel_AC.ValueText,First(varRecord).EligibilityLevel),
        		RequiredTrainingAccess:
                    {
                        PR_ID:varPRID,
                        GovernmentNetworkorSystems:Coalesce(cmp_GovermentInformation_EI.ValueText,First(varRecord).Training.GovernmentNetworkorSystems),
                        ForeignNationalsorEngagement:Coalesce(cmp_Foreign_IE.ValueText,First(varRecord).Training.ForeignNationalsorEngagement),
                        DoDEmail:Coalesce(cmp_DoDEmail_EI.ValueText,First(varRecord).Training.DoDEmail),
                        BuildingBadge:Coalesce(cmp_BuildingBadge_EI.ValueText,First(varRecord).Training.BuildingBadge),
                        CAC:Coalesce(cmp_CAC_EI.ValueText,First(varRecord).Training.CAC),
                        SIPRToken:Coalesce(cmp_SIPRToken_EI.ValueText,First(varRecord).Training.SIPRToken),
                        BoozAllenLaptop:Coalesce(cmp_BoozAllenLaptop_EI.ValueText,First(varRecord).Training.BoozAllenLaptop),
                        GFELaptop:Coalesce(cmp_GovermentLaptop_EI.ValueText,First(varRecord).Training.GFELaptop),
                        DoDFacilitiesControlledAccess:Coalesce(cmp_DoDInstallations_EI.ValueText,First(varRecord).Training.DoDFacilitiesControlledAccess),
                        BIXTARsRIPs:Coalesce(cmp_BIXtosubmit_EI.ValueText,First(varRecord).Training.BIXTARsRIPs),
                        A365Access:Coalesce(cmp_EARTHATLASA365_EI.ValueText,First(varRecord).Training.A365Access)
                    },           
                TDLSub:
                ForAll(gal_TDLs_EI.AllItems,
        			{
                        PR_ID:varPRID,
                        TDLNumber:Icn_gal_TDL_number_EI.Text,
                        Primary:If(chk_gal_TDL_EI.Value,"Yes","No"),
                        EmployeeName:cmp_EmployeeName_EI.ValueText,
                        EmployeeType:cmp_EmployeeType_EI.ValueText
                    }),
                OutProcessing:
                    {
                        PR_ID:varPRID,
                        CACStatus:Coalesce(cmp_CACStatus_OP.ValueText,First(varRecord).OutProcessing.CACStatus),
                        BuildingBadgeStatus:Coalesce(cmp_BuidingBadgeStatus_OP.ValueText,First(varRecord).OutProcessing.BuildingBadgeStatus),
                        SIPRTokenStatus:Coalesce(cmp_SIPRTokenStatus_OP.ValueText,First(varRecord).OutProcessing.SIPRTokenStatus),
                        HandReceiptsCleared:Coalesce(cmp_HandRecieptCleared_OP.ValueText,First(varRecord).OutProcessing.HandReceiptsCleared),
                        BIXClosedOut:Coalesce(cmp_BIXCloseOut_OP.ValueText,First(varRecord).OutProcessing.BIXClosedOut),
                        AirfareExpensesCleared:Coalesce(cmp_AirfareExpensesCleared_OP.ValueText,First(varRecord).OutProcessing.AirfareExpensesCleared),
                        OutProcessingCompleted:Coalesce(cmp_OutProcessingComplete_OP.ValueText,First(varRecord).OutProcessing.OutProcessingCompleted),
                        OutProcessingDate:Coalesce(cmp_FinalOutProcessingDate_OP.ValueDate,First(varRecord).OutProcessing.OutProcessingDate), //Date
                        OutProcessingStatus:Coalesce(cmp_OutProcessingStatus_OP.ValueText,First(varRecord).OutProcessing.OutProcessingStatus)
                    },
                RelocationInfo:
                    {
                        PR_ID:varPRID,
                        FirstLastName:cmp_EmployeeName_EI.ValueText,
                        PrimaryTDL:varPrimaryTDL,
                        OnboardingDate:cmp_reloonboardingdate_EI.ValueDate, //Date
                        FromLocation:cmp_relofrom_EI.ValueText,
                        FamilySize:cmp_relofamilysize_EI.ValueText,
                        RelocationDate:cmp_relodate_EI.ValueDate, //Date
                        FamilyAccompanyOnRelocationDate:cmp_relofamilyaccompany_EI.ValueDate, //Date
                        IfNoFamilyDepartureDate:cmp_reloPlannedDepart_EI.ValueDate, //Date
                        AssignmentAgreementStatus:cmp_reloAggreement_EI.ValueText
            		},
                TrainingTable:
                    {
                        PR_ID:varPRID,
                        Status:cmp_TaskOrderStatus_EI.ValueText,
                        PrimaryTDL:varPrimaryTDL,
                        ATLevel1:varRecordTrainingTable.ATLevel1,
                        CyberAwareness:varRecordTrainingTable.CyberAwareness,
                        DerivativeClass:varRecordTrainingTable.DerivativeClass,
                        MarkingClass:varRecordTrainingTable.MarkingClass,
                        OPSEC:varRecordTrainingTable.OPSEC,
                        iWATCH:varRecordTrainingTable.iWATCH,
                        ExportControl:varRecordTrainingTable.ExportControl,
                        OnBoarding:varRecordTrainingTable.OnBoarding,
                        SPLJMTraining:varRecordTrainingTable.SPLJMTraining,
                        SecurityPledge:varRecordTrainingTable.SecurityPledge
                    }
            };
            //test2
    OnStart: |-
        =Set(
            toolInformation,
            ShowColumns(
                LookUp(
                    MALT_ToolInformation,
                    AppReference = appReference
                ),
                AppReference,
                AppName,
                VersionNumber,
                AssociatedLists,
                Icon,
                AppLink,
                SolutionLink,
                Permissions,
                AssociatedFlows,
                POCName,
                POCEmail,
                DocumentationLink,
                HowToLink,
                PublishedDate,
                PublishedBy,
                RecentNotes1,
                RecentNotes2,
                RecentNotes3,
                TotalPatchNotes
            )
        );
        Set(
            ThisTheme,
            With(
                {
                    _theme: LookUp(
                        TemplateSettings,
                        Title = templateSetting
                    )
                },
                {
                    Name: _theme.Title,
                    Color1: ColorValue(_theme.Color1),
                    Color2: ColorValue(_theme.Color2),
                    Color3: ColorValue(_theme.Color3),
                    Color1Text: ColorValue(_theme.Color1Text),
                    Color2Text: ColorValue(_theme.Color2Text),
                    Color3Text: ColorValue(_theme.Color3Text),
                    BackgroundColor: ColorValue(_theme.BackgroundColor),
                    AppColor: ColorValue(_theme.AppColor),
                    AppColorText: ColorValue(_theme.AppColorText),
                    ChartColors: _theme.ChartColors,
                    defaultFill: ColorValue(_theme.defaultFillColor),
                    defaultTextColor: ColorValue(_theme.defaultTextColor),
                    Font: _theme.Font,
                    FontSize: _theme.FontSize,
                    DarkMode: false
                }
            )
        );
        ///////////////////////////////////
        //                               //
        //  Your Code From Here onwards  //
        //                               //
        ///////////////////////////////////
        //
        //Collection from the All ET2RC Security Group// 
        Set(
            varEmpID,
            Coalesce(
                Param("empId"),
                Left(User().Email,6)
            )
        );
        
        // Load record for the current user
        Set(myEmail,User().Email);
        Set(loadRecord,true);
        
        Set(
            varRecordType,
            "self"
        );
        Set(
            varUserPermission,
            "member"
        );
        ClearCollect(
            colRecordTrainingTable,
            ShowColumns(
                Filter(
                    PRTrainingTable,
                    Or(
                        Status = "Active",
                        Status = "On Leave",
                        Status = "Out-Processing",
                        Status = "Temporary"
                    )
                ),
                PR_ID,
                Status,
                PrimaryTDL,
                ATLevel1,
                CyberAwareness,
                DerivativeClass,
                MarkingClass,
                OPSEC,
                iWATCH,
                ExportControl,
                OnBoarding,
                SPLJMTraining,
                SecurityPledge
            )
        );
        Set(
            varRecordTrainingTable,
            LookUp(
                colRecordTrainingTable,
                PR_ID = varPRID
            )
        );
        /*
        ClearCollect(
            colPersonnel,
            ShowColumns(
                PersonnelRoster,
                Reference_ID,
                EmployeeType,
                TaskOrderStatus,
                TaskOrderStartDate,
                EmployeeName,
                EmployeeLastName,
                EmployeeFirstName,
                AccountGroup,
                EmployeeID,
                CompanyEmail,
                Company,
                PrimaryPhone,
                LocationType,
                DutyLocation,
                Country,
                State,
                City,
                ReturnDate,
                EmailNotificationPreference,
                LCAT,
                JobLeader,
                RequiresRelocation,
                BIXProjectRole,
                BIXAccountStatus,
                OktaStatus,
                ET2RCDistro,
                A365Status,
                A365DateChange,
                LCATValidated,
                WelcomeEmailSent,
                CurrentAccessLevel,
                EligibilityLevel
            )
        );
        */
        //test2
    StartScreen: ='Loading Screen'
    Theme: =PowerAppsTheme

    Host As hostControl.DefaultHostControlVariant:
        OnCancel: =false
        OnEdit: =false
        OnNew: =false
        OnSave: =false
        OnView: =false

